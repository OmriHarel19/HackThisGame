#bet calculation exploit
from pwn import *

conn = process('/mnt/c/Users/עמרי/Documents/GitHub/HackThisGame/tictactoe')

#important values:
bet = "100"
b_len, r_len = 3,3
random = 1804289383

#payload
guess = 0xdeadbeef - random
#interact with program:
#choose to signin
print(conn.recvuntil("type s:").decode())
conn.sendline("s")
#name:
print(conn.recvuntil("Enter your name (should not be more than 10 chars!!):").decode())
conn.sendline("aaa")
#password:
print(conn.recvuntil("safe... or is it?):").decode())
conn.sendline("aaa")
#bet: enter malicious bet
print(conn.recvuntil("so don't get exited...").decode())
print(conn.recvline())
conn.sendline(bet)
#board len:
print(conn.recvuntil("board length:").decode())
conn.sendline(str(b_len))
#reach len:
print(conn.recvuntil("reach length:").decode())
conn.sendline(str(r_len))
#play game: let O win
for i in range(2,8):
    print(conn.recvuntil("in:").decode())
    conn.sendline(str(i))
# send guess (knowing that random is always: 1804289383)
print(conn.recvuntil("thinking of:").decode())
conn.sendline(str(guess))
conn.interactive()
